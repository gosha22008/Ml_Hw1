# Ml_Hw1

## Первое домашнее задание по курсу ML.
Описание файлов:
1. Копия_блокнота__AI_HW1_Regression_with_inference_base_ipynb_ (3) - ноутбук со всеми проведёнными экспериментами
2. my_report - сохраненный дашборд в формате html
3. model.pkl - сохранённая модель в pickle
4. onehotencoder.pkl - сохранённый обученный OneHotEncoder в pickle
5. simpleimputer.pkl - сохранённый SimpleImputer в pickle
6. standartscaler.pkl - сохранённый StandardScaler в pickle
7. servis.py - сервис FastApi
8. requirements.txt - файл зависимостей

### Выводы по проделанной работе:
    Был проведен EDA данных. Рассмотрены визуализации, заполнены пропуски медианным значением, преобразованы категориальные столбцы, отброшены ед. измерения в некоторых столбцах. Были обнаружены некоторые зависимости в данных, мы выяснили, что больше всего на прогноз моделей влияет max_power.
    Посчитана бизнес метрика - Среди всех предсказанных цен на авто нужно посчитать долю прогнозов, отличающихся от реальных цен на эти авто не более чем на 10% (в одну или другую сторону). Найдена лучшаа модель по этой метрике(она же просто лучшая модель)

    Результатов удалось добиться средних. Вероятно из-за простоты модели. Скорее всего более сложные модели показали бы лучший результат. Также можно ещё лучше обработать данные.

    Наибольший буст в качестве дало использование максимального количества столбцов. Т.е. качество улучшилось после того как я закодировал категориальные переменные и использовал их.

    Cделан с помощью FastAPI сервис, который с точки зрения пользователя реализует две функции:
    1. на вход в формате json подаются признаки одного объекта, на выходе сервис выдает предсказанную стоимость машины
    2. на вход подается csv-файл с признаками тестовых объектов, на выходе получаем файл с +1 столбцом - предсказаниями на этих объектах

    С точки зрения реализации это означает следующее:
    1. средствами pydantic должен быть описан класс базового объекта
        класс с коллецией объектов
    2. метод post, который получает на вход один объект описанного класса
    3. метод post, который получает на вход коллекцию объектов описанного класса

# Результаты работы сервиса можно посмотреть запустив сам сервис, а так же на приложенных скриншотах.
1. Запрос к сервису на предсказание одного объекта
![Запрос к сервису на предсказание одного объекта](скриншоты/2024-12-01_16-29-58.png)
1. Ответ сервиса с предсказанием цены одного объекта
![Ответ сервиса с предсказанием цены одного объекта](скриншоты/2024-12-01_16-30-18.png)
3. Запрос к сервису на предсказание списка объектов(список из одного элемента)
![Запрос к сервису на предсказание списка объектов](скриншоты/2024-12-01_16-31-29.png)
4. Ответ сервиса с предсказанием списка объектов(список из одного элемента)
![Ответ сервиса с предсказанием списка объектов ](скриншоты/2024-12-01_16-32-04.png)
5. Запрос к сервису на предсказаине списка объектов(список из двух элементов)
![Запрос к сервису на предсказаине списка объектов](скриншоты/2024-12-01_16-40-28.png)
6. Ответ сервиса с предсказанием списка объектов(список из двух элементов)
![Ответ сервиса с предсказанием списка объектов](скриншоты/2024-12-01_16-40-48.png)
7. Демонстрация работы сервиса из VS code. Запрос к сервису на предсказание первого элемента из df_train, двух первых элементов из df_train
![Демонстрация работы сервиса из VS code. Запрос к сервису на предсказание первого элемента из df_train](скриншоты/2024-12-01_18-35-50.png)
8. Ответ сервиса 
![Ответ сервиса](скриншоты/2024-12-01_18-35-58.png)